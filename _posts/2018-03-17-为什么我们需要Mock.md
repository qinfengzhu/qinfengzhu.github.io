---
layout: post
title: "为什么我们需要Mock"
date: 2018-03-17   
tag: 工具
---

### 单元测试的由来

1. 软件其实就是一块一块功能的堆叠,软件开发过程中奉行高内聚低耦合,很多模块之间都是相互独立的,模块之间的依赖变的松散。所以我们开发者希望看到的:
如果每一个模块我们能够确保功能正常,那么当各个模块组合在一起的时候就可以完美工作了。如何确保每一个模块都是按照期望进行运行,那么就要对每一个期望设置预期,然后预期与实际运行是一样的，我们就认为这个模块是OK的。

### 单元测试的原则

1. __快速的__ 单元测试应能快速运行，如果运行缓慢，就不会愿意频繁运行它。
2. __独立的__ 单元测试应相互独立，某个测试不应为下一个测试设定条件。当测试相互依赖时，一个没通过就会导致一连串的失败，难以定位问题。
3. __可重复的__ 单元测试应该是可以重复执行的，并且结果是可以重现的。
4. __自我验证的__ 单元测试应该有布尔输出，无论是通过或失败，不应该查看日志文件或手工对比不同的文本文件来确认测试是否通过。
5. __及时的__  及时编写单元测试代码，应恰好在开发实际的单元代码之前。
6. __原子的__ 针对模块中最小的逻辑片段。

### 一般的单元测试框架xNunit能够做哪些

1. 单个函数
2. 单个class
3. 几个功能相关class的测试
4. 纯函数测试
5. 接口级别的测试

### 为什么需要Mock

1. 真实对象具有不可确定的行为（产生不可预测的结果）
2. 真实对象很难被创建（如具体的Web容器）
3. 真实对象的某些行为很难触发（如网络错误）
4. 真实情况令程序的运行速度很慢
5. 真实对象有用户界面
6. 测试需要询问真实对象它是如何被调用的
7. 真实对象实际上并不存在

### Mock出来的伪对象在哪里使用

1. 不同模块的完整集成测试的时候,我们需要很多伪对象,因为真实的对象会很复杂,而且有时候会跟资源进行交互(比如数据库),最后的结果就是得出的结果不可预料。
但是我们是测试功能,所以我们期望模块返回的结果是自己定义预见的。

### 开源的Mock以及常用的方式

1. C# 方面的框架选用[Moq4](https://github.com/Moq/moq4/wiki/Quickstart)
2. C# 方面的框架选用[Rhino Mocks](http://www.hibernatingrhinos.com/oss/rhino-mocks)
3. C# 方面的框架选用[NMock](https://archive.codeplex.com/?p=nmock3)


### 测试驱动开发(TDD)

